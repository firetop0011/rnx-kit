"use strict";(self.webpackChunk_rnx_kit_docsite=self.webpackChunk_rnx_kit_docsite||[]).push([[7573],{193:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>l,contentTitle:()=>d,default:()=>h,frontMatter:()=>s,metadata:()=>c,toc:()=>a});var r=t(5893),i=t(1151);const s={},d="cli",c={id:"tools/cli",title:"cli",description:"Command-line interface for working with packages in your repo.",source:"@site/docs/tools/cli.md",sourceDirName:"tools",slug:"/tools/cli",permalink:"/rnx-kit/docs/tools/cli",draft:!1,unlisted:!1,editUrl:"https://github.com/microsoft/rnx-kit/tree/main/docsite/docs/tools/cli.md",tags:[],version:"current",frontMatter:{},sidebar:"toolsSidebar",previous:{title:"bundle-diff",permalink:"/rnx-kit/docs/tools/bundle-diff"},next:{title:"config",permalink:"/rnx-kit/docs/tools/config"}},l={},a=[{value:"Bundle a Package",id:"bundle-a-package",level:2},{value:"Example Commands",id:"example-commands",level:3},{value:"Example Configuration (Optional)",id:"example-configuration-optional",level:3},{value:"Bundle Defaults",id:"bundle-defaults",level:3},{value:"Command-Line Overrides",id:"command-line-overrides",level:3},{value:"Start a Bundle Server",id:"start-a-bundle-server",level:2},{value:"Example Commands",id:"example-commands-1",level:3},{value:"Example Configuration",id:"example-configuration",level:3},{value:"Server Defaults",id:"server-defaults",level:3},{value:"Command-Line Overrides",id:"command-line-overrides-1",level:3},{value:"Manage Dependencies",id:"manage-dependencies",level:2},{value:"Generate a Third-Party Notice for a Package",id:"generate-a-third-party-notice-for-a-package",level:2},{value:"Clean a React Native Project",id:"clean-a-react-native-project",level:2}];function o(e){const n={a:"a",blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",...(0,i.a)(),...e.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(n.h1,{id:"cli",children:"cli"}),"\n",(0,r.jsx)(n.p,{children:"Command-line interface for working with packages in your repo."}),"\n",(0,r.jsx)(n.h2,{id:"bundle-a-package",children:"Bundle a Package"}),"\n",(0,r.jsxs)(n.p,{children:["Bundle a package using ",(0,r.jsx)(n.a,{href:"https://facebook.github.io/metro",children:"Metro"}),". The bundling\nprocess uses optional\n",(0,r.jsx)(n.a,{href:"https://github.com/microsoft/rnx-kit/tree/main/packages/config",children:"configuration"}),"\nparameters and command-line overrides."]}),"\n",(0,r.jsxs)(n.p,{children:["The command ",(0,r.jsx)(n.code,{children:"react-native rnx-bundle"})," is meant to be a drop-in replacement for\n",(0,r.jsx)(n.code,{children:"react-native bundle"}),". If ",(0,r.jsx)(n.code,{children:"rnx-bundle"})," ever becomes widely accepted, we will\nwork on upstreaming it to ",(0,r.jsx)(n.code,{children:"@react-native-community/cli"}),", along with supporting\nlibraries for package configuration and Metro plugins."]}),"\n",(0,r.jsx)(n.h3,{id:"example-commands",children:"Example Commands"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"yarn react-native rnx-bundle\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"yarn react-native rnx-bundle       \\\n    --entry-file src/index.ts      \\\n    --bundle-output main.jsbundle  \\\n    --platform ios                 \\\n    --dev false                    \\\n    --minify true\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-configuration-optional",children:"Example Configuration (Optional)"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "rnx-kit": {\n    "bundle": {\n      "entryFile": "entry.js",\n      "assetsDest": "dist",\n      "plugins": [\n        "@rnx-kit/metro-plugin-cyclic-dependencies-detector",\n        [\n          "@rnx-kit/metro-plugin-duplicates-checker",\n          { "ignoredModules": ["react-is"] }\n        ],\n        "@rnx-kit/metro-plugin-typescript"\n      ],\n      "targets": ["ios", "android", "windows", "macos"],\n      "platforms": {\n        "android": {\n          "assetsDest": "dist/res"\n        },\n        "macos": {\n          "plugins": [\n            "@rnx-kit/metro-plugin-cyclic-dependencies-detector",\n            [\n              "@rnx-kit/metro-plugin-duplicates-checker",\n              { "ignoredModules": ["react-is"] }\n            ]\n          ]\n        }\n      }\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"bundle-defaults",children:"Bundle Defaults"}),"\n",(0,r.jsx)(n.p,{children:"When certain parameters aren't specified in configuration or on the\ncommand-line, they are explicitly set to default values."}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Parameter"}),(0,r.jsx)(n.th,{children:"Default Value"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"entryFile"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'"index.js"'})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"bundleOutput"}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.code,{children:'"index.<platform>.bundle"'})," (Windows, Android) or ",(0,r.jsx)(n.code,{children:'"index.<platform>.jsbundle"'})," (iOS, macOS)"]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"hermes"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"treeShake"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:"false"})})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"plugins"}),(0,r.jsx)(n.td,{children:(0,r.jsx)(n.code,{children:'["@rnx-kit/metro-plugin-cyclic-dependencies-detector", "@rnx-kit/metro-plugin-duplicates-checker", "@rnx-kit/metro-plugin-typescript"]'})})]})]})]}),"\n",(0,r.jsx)(n.p,{children:"Other parameters have implicit defaults, buried deep in Metro or its\ndependencies."}),"\n",(0,r.jsx)(n.h3,{id:"command-line-overrides",children:"Command-Line Overrides"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Override"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--id [id]"}),(0,r.jsx)(n.td,{children:"Target bundle definition. This is only needed when the rnx-kit configuration has multiple bundle definitions."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--entry-file [file]"}),(0,r.jsx)(n.td,{children:"Path to the root JavaScript or TypeScript file, either absolute or relative to the package."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["--platform [",(0,r.jsx)(n.code,{children:"ios"})," | ",(0,r.jsx)(n.code,{children:"android"})," | ",(0,r.jsx)(n.code,{children:"windows"})," | ",(0,r.jsx)(n.code,{children:"win32"})," | ",(0,r.jsx)(n.code,{children:"macos"}),"]"]}),(0,r.jsx)(n.td,{children:"Target platform. When not given, all platforms in the rnx-kit configuration are bundled."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--dev [boolean]"}),(0,r.jsx)(n.td,{children:"If false, warnings are disabled and the bundle is minified (default: true)."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--minify [boolean]"}),(0,r.jsx)(n.td,{children:"Controls whether or not the bundle is minified. Disabling minification is useful for test builds."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--bundle-output [path]"}),(0,r.jsx)(n.td,{children:"Path to the output bundle file, either absolute or relative to the package."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsxs)(n.td,{children:["--bundle-encoding [",(0,r.jsx)(n.code,{children:"utf8"})," | ",(0,r.jsx)(n.code,{children:"utf16le"})," | ",(0,r.jsx)(n.code,{children:"ascii"}),"]"]}),(0,r.jsxs)(n.td,{children:[(0,r.jsx)(n.a,{href:"https://nodejs.org/api/buffer.html#buffer_buffers_and_character_encodings",children:"Character encoding"})," to use when writing the bundle file."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--max-workers [number]"}),(0,r.jsx)(n.td,{children:"Specifies the maximum number of parallel worker threads to use for transforming files. This defaults to the number of cores available on your machine."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--sourcemap-output [string]"}),(0,r.jsx)(n.td,{children:"Path where the bundle source map is written, either absolute or relative to the package."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--sourcemap-sources-root [string]"}),(0,r.jsx)(n.td,{children:"Path to use when relativizing file entries in the bundle source map."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--assets-dest [path]"}),(0,r.jsx)(n.td,{children:"Path where bundle assets like images are written, either absolute or relative to the package. If not given, assets are ignored."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--tree-shake [boolean]"}),(0,r.jsx)(n.td,{children:"Enable tree shaking to remove unused code and reduce the bundle size."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--reset-cache"}),(0,r.jsx)(n.td,{children:"Reset the Metro cache."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--config [string]"}),(0,r.jsx)(n.td,{children:"Path to the Metro configuration file."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"-h, --help"}),(0,r.jsx)(n.td,{children:"Show usage information."})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"start-a-bundle-server",children:"Start a Bundle Server"}),"\n",(0,r.jsxs)(n.p,{children:["Start a bundle server for a package using\n",(0,r.jsx)(n.a,{href:"https://facebook.github.io/metro",children:"Metro"}),". The bundle server uses optional\n",(0,r.jsx)(n.a,{href:"https://github.com/microsoft/rnx-kit/tree/main/packages/config",children:"configuration"}),"\nparameters and command-line overrides."]}),"\n",(0,r.jsxs)(n.p,{children:["The command ",(0,r.jsx)(n.code,{children:"react-native rnx-start"})," is meant to be a drop-in replacement for\n",(0,r.jsx)(n.code,{children:"react-native start"}),". If ",(0,r.jsx)(n.code,{children:"rnx-start"})," ever becomes widely accepted, we will work\non upstreaming it to ",(0,r.jsx)(n.code,{children:"@react-native-community/cli"}),", along with supporting\nlibraries for package configuration and Metro plugins."]}),"\n",(0,r.jsx)(n.h3,{id:"example-commands-1",children:"Example Commands"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"yarn react-native rnx-start\n"})}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-sh",children:"yarn react-native rnx-start --host localhost --port 8812\n"})}),"\n",(0,r.jsx)(n.h3,{id:"example-configuration",children:"Example Configuration"}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{className:"language-json",children:'{\n  "rnx-kit": {\n    "server": {\n      "projectRoot": "src",\n      "plugins": [\n        "@rnx-kit/metro-plugin-cyclic-dependencies-detector",\n        [\n          "@rnx-kit/metro-plugin-duplicates-checker",\n          {\n            "ignoredModules": ["react-is"],\n            "throwOnError": false\n          }\n        ],\n        "@rnx-kit/metro-plugin-typescript"\n      ]\n    }\n  }\n}\n'})}),"\n",(0,r.jsx)(n.h3,{id:"server-defaults",children:"Server Defaults"}),"\n",(0,r.jsxs)(n.p,{children:["If the server configuration is not defined, it is implicitly created at runtime\nfrom the bundle configuration (or its ",(0,r.jsx)(n.a,{href:"#bundle-defaults",children:"defaults"}),")."]}),"\n",(0,r.jsx)(n.h3,{id:"command-line-overrides-1",children:"Command-Line Overrides"}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Override"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--port [number]"}),(0,r.jsx)(n.td,{children:"Host port to use when listening for incoming server requests."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--host [string]"}),(0,r.jsx)(n.td,{children:"Host name or address to bind when listening for incoming server requests. When not given, requests from all addresses are accepted."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--projectRoot [path]"}),(0,r.jsx)(n.td,{children:"Path to the root of your react-native project. The bundle server uses this root path to resolve all web requests."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--watchFolders [paths]"}),(0,r.jsx)(n.td,{children:"Additional folders which will be added to the file-watch list. Comma-separated. By default, Metro watches all project files."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--assetPlugins [list]"}),(0,r.jsx)(n.td,{children:"Additional asset plugins to be used by the Metro Babel transformer. Comma-separated list containing plugin module names or absolute paths to plugin packages."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--sourceExts [list]"}),(0,r.jsx)(n.td,{children:"Additional source-file extensions to include when generating bundles. Comma-separated list, excluding the leading dot."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--max-workers [number]"}),(0,r.jsx)(n.td,{children:"Specifies the maximum number of parallel worker threads to use for transforming files. This defaults to the number of cores available on your machine."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--reset-cache"}),(0,r.jsx)(n.td,{children:"Reset the Metro cache."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--custom-log-reporter-path [string]"}),(0,r.jsxs)(n.td,{children:["Path to a JavaScript file which exports a Metro ",(0,r.jsx)(n.code,{children:"TerminalReporter"})," function. This replaces the default reporter, which writes all messages to the Metro console."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--https"}),(0,r.jsx)(n.td,{children:"Use a secure (https) web server. When not specified, an insecure (http) web server is used."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--key [path]"}),(0,r.jsx)(n.td,{children:"Path to a custom SSL private key file to use for secure (https) communication."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--cert [path]"}),(0,r.jsx)(n.td,{children:"Path to a custom SSL certificate file to use for secure (https) communication."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--config [string]"}),(0,r.jsx)(n.td,{children:"Path to the Metro configuration file."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--no-interactive"}),(0,r.jsx)(n.td,{children:"Disables interactive mode."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--id"}),(0,r.jsx)(n.td,{children:"Specify which bundle configuration to use if server configuration is missing."})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"manage-dependencies",children:"Manage Dependencies"}),"\n",(0,r.jsx)(n.p,{children:"Manage dependencies within a repository and across many repositories."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ yarn react-native rnx-align-deps [options] [/path/to/package.json]\n"})}),"\n",(0,r.jsxs)(n.p,{children:["Refer to\n",(0,r.jsx)(n.a,{href:"https://github.com/microsoft/rnx-kit/tree/main/packages/align-deps",children:"@rnx-kit/align-deps"}),"\nfor details."]}),"\n",(0,r.jsx)(n.h2,{id:"generate-a-third-party-notice-for-a-package",children:"Generate a Third-Party Notice for a Package"}),"\n",(0,r.jsx)(n.p,{children:"Generate a 3rd-party notice, which is an aggregation of all the LICENSE files\nfrom your package's dependencies."}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["NOTE: A 3rd-party notice is a ",(0,r.jsx)(n.strong,{children:"legal document"}),". You are solely responsble\nfor its content, even if you use this command to assist you in generating it.\nYou should consult with an attorney to ensure your notice meets all legal\nrequirements."]}),"\n"]}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ yarn react-native rnx-write-third-party-notices [options]\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--root-path [path]"}),(0,r.jsx)(n.td,{children:"The root of the repo. This is the starting point for finding each module in the source map dependency graph."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--source-map-file [file]"}),(0,r.jsx)(n.td,{children:"The source map file associated with the package's entry file. This source map eventually leads to all package dependencies and their licenses."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--json"}),(0,r.jsx)(n.td,{children:"Format the 3rd-party notice file as JSON instead of text."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--output-file [file]"}),(0,r.jsx)(n.td,{children:"The path to use when writing the 3rd-party notice file."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--ignore-scopes [string]"}),(0,r.jsxs)(n.td,{children:["Comma-separated list of ",(0,r.jsx)(n.code,{children:"npm"})," scopes to ignore when traversing the source map dependency graph."]})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--ignore-modules [string]"}),(0,r.jsx)(n.td,{children:"Comma-separated list of modules to ignore when traversing the source map dependency graph."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--preamble-text [string]"}),(0,r.jsx)(n.td,{children:"A string to prepend to the start of the 3rd-party notice."})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--additional-text [path]"}),(0,r.jsx)(n.td,{children:"A string to append to the end of the 3rd-party notice."})]})]})]}),"\n",(0,r.jsx)(n.h2,{id:"clean-a-react-native-project",children:"Clean a React Native Project"}),"\n",(0,r.jsxs)(n.blockquote,{children:["\n",(0,r.jsxs)(n.p,{children:["Deprecated: This command was upstreamed to ",(0,r.jsx)(n.code,{children:"@react-native-community/cli"}),". As\nof ",(0,r.jsx)(n.a,{href:"https://github.com/react-native-community/cli/releases/tag/v8.0.0",children:"v8.0"}),",\nyou can use ",(0,r.jsx)(n.code,{children:"react-native clean"})," instead."]}),"\n"]}),"\n",(0,r.jsx)(n.p,{children:"Cleans your project by removing React Native related caches and modules."}),"\n",(0,r.jsx)(n.pre,{children:(0,r.jsx)(n.code,{children:"$ yarn react-native rnx-clean [options]\n"})}),"\n",(0,r.jsxs)(n.table,{children:[(0,r.jsx)(n.thead,{children:(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.th,{children:"Option"}),(0,r.jsx)(n.th,{children:"Description"})]})}),(0,r.jsxs)(n.tbody,{children:[(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--include [string]"}),(0,r.jsx)(n.td,{children:"Comma-separated flag of caches to clear e.g npm,yarn . When not specified , only non-platform specific caches are cleared. [android,cocoapods,npm,metro,watchman,yarn]"})]}),(0,r.jsxs)(n.tr,{children:[(0,r.jsx)(n.td,{children:"--project-root [path]"}),(0,r.jsx)(n.td,{children:"Root path to your React Native project. When not specified, defaults to current working directory"})]})]})]})]})}function h(e={}){const{wrapper:n}={...(0,i.a)(),...e.components};return n?(0,r.jsx)(n,{...e,children:(0,r.jsx)(o,{...e})}):o(e)}},1151:(e,n,t)=>{t.d(n,{Z:()=>c,a:()=>d});var r=t(7294);const i={},s=r.createContext(i);function d(e){const n=r.useContext(s);return r.useMemo((function(){return"function"==typeof e?e(n):{...n,...e}}),[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:d(e.components),r.createElement(s.Provider,{value:n},e.children)}}}]);